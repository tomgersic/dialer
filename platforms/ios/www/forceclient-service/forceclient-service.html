<link rel="import" href="../components/polymer/polymer.html">

<polymer-element name="forceclient-service">
  <script>
  (function() {
    var firstName = 'John';
    var lastName = 'Smith';
    var forceClient = new forcetk.Client();

    Polymer({
       ready: function() {
         this.firstName = firstName;
         this.lastName = lastName;
       },
       authenticateUser:function(successHandler, errorHandler) {
        alert("Authenticate User Called");

        // Get salesforce mobile sdk OAuth plugin
        var oauthPlugin = cordova.require("com.salesforce.plugin.oauth");

        // Call getAuthCredentials to get the initial session credentials
        oauthPlugin.getAuthCredentials(
            // Callback method when authentication succeeds.
            function (creds) {
                // Create forcetk client instance for rest API calls
                forceClient.setSessionToken(creds.accessToken, "v31.0", creds.instanceUrl);

                // Call success handler and handover the forcetkClient
                successHandler(forceClient);

            },
            function (error) {
                alert('Failed to authenticate user: ' + error);
            }
        );
    }
    });
  })();
  </script>
</polymer-element>